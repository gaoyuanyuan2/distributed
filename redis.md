## Redis
#### Redis 是一个开源的使用 ANSI C 语言编写、支持网络、可基于内存亦可持久化的日志型、 Key-Value数据库 ，epoll 所以高性能
### 1、用途
<br>缓存，数据库，消息中间件，热点数据，临时数据
### 2、持久化
<br>1. 	RDB持久化
<br>RDB压缩的二进制文件用于保存和还原Redis服务器所有数据库中的所有键值对数据）。SAVE命令由服务器进程直接保存操作，所有该命令会阻塞服务器。BGSAVE
由子进程执行保存操作，所以该命令不会阻塞服务器。（间隔保存，会丢失数据）
<br><br>2. 	AOF持久化
<br>AOF日志文件通过保存所有修改数据库的命令请求来记录服务器的数据库状态。AOF重写文件体积变小。（每秒同步，每修改同步，不同步）文件大、效率较低。新文件会覆盖旧的文件（定时转移走）。 
### 3、原理
<br>1.	链表:实现Redis的各种功能,比如列表键、发布与订阅、满查询、监视器。
<br><br>2.	字典：使用哈希表作为底层实现。字典被用作数据库（哈希键）的底层实现。
<br><br>3.	解决键冲突： Redis的哈希表使用链地址法来解决键冲突，每个哈希表节点都有一个next指针，多个哈希表节点可以用next指针构成一个单向链表，被分配到同一个索引上的多个节点可以用这个单向链表连接起来，这样就解决了键冲突问题。
<br><br>4.	跳跃表是有序集合的底层实现之一。
<br><br>5.	整数集合是集合键的底层实现之一。（底层实现为数组）
<br><br>6.	压缩列表是列表键和哈希键的底层实现之一。
<br><br>7.	Redis的对象系统实现了基于引用计数的内存回收机制。
<br><br>8. 	Redis共有字符串、列表、哈希、集合、有序集合五种类型的对象。当一个对象不再被使用时，该对象所占用的内存就会自动释放。
<br><br>9.	设置键的生存时间或过期时间。
<br><br>10.	当主服务器删除一个过期键之后，他会向所有从服务器发送一条DEL命令，显式地删除过期键。当Redis命令对数据库进行修改之后，服务器会根据配置项客户端发送数据库通知。
<br><br>11.	Redis服务器是一个事件驱动程序，服务器处理的事件分时间事件和文件事件两类。
<br><br>12.	客户端：Redis服务器是典型的一对多服务器程序：通过使用I/O多路复用技术实现文件事件处理器。
###	4、Sentinel(哨兵)
<br>是Redis高可用性的解决方案。一般10s每次的频率向被监视的主服务器和从服务器发送INFO命令，当主服务器处于下线状态，或者Sentinel
正在对主服务器进行故障转移操作是，发送频率会改成每秒一次。每个主节点一个从节点，故障从提主。自动。基数防脑裂。
###	5、集群
<br>节点通过握手来将其他节点添加到自己所处的集群当中。无中心节点
<br>集群中的16384个槽可以分别平均指派给集群中的各个节点，每个节点都会记录哪些槽指派给了自己，而哪些槽又被指派给了其他节点，
<br>集群里的从节点用于复制主节点，并在主节点下线时，代替主节点继续处理命令请求。
<br>集群中的节点通过发送和接收消息来进行通信，常见的消息包括MEET、PING、PONG、PUBLISH、FAIL。
### 6、发布和订阅
<br>由PUBLISH,SUBSCRIBE,PSUBSCRIBE命令组成。
<br>发送到频道，订阅频道（PUBLISH <channel><message>）。
<br><br>Redis实现消息队列原理
<br>发布者和订阅者模式：发布者发送消息到队列，每个订阅者都能收到一样的消息。 
<br>生产者和消费者模式：生产者将消息放入队列，多个消费者共同监听，谁先抢到资源，谁就从队列中取走消息去处理。注意，每个消息只能最多被一个消费者接收。
### 7、Redis事务
<br>MULTI(队列中、原子化地执行)（发起）
<br>EXEC（当使用WATCH命令时，只有当受监控的键没有被修改时，EXEC命令才会执行事务中的命令，如果事务执行中止，那么EXEC命令就会返回一个Null值）（提交）
<br>DISCARD清除所有先前在一个事务中放入队列的命令，然后恢复正常的连接状态。（回滚）
<br>WATCH等命令来实现事物功能。
<br>运行时错误 事务不回滚

















